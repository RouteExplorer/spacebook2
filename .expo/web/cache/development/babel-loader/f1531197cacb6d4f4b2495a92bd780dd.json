{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from \"react\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\nimport { TouchableOpacity } from \"react-native-gesture-handler\";\nimport Style from \"./Style\";\nimport UploadDrafts from \"./UploadDraft\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\n\nvar MyFreinds = function (_Component) {\n  _inherits(MyFreinds, _Component);\n\n  var _super = _createSuper(MyFreinds);\n\n  function MyFreinds(props) {\n    var _this;\n\n    _classCallCheck(this, MyFreinds);\n\n    _this = _super.call(this, props);\n\n    _this.checkLoggedIn = function _callee() {\n      var value;\n      return _regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return _regeneratorRuntime.awrap(AsyncStorage.getItem(\"@session_token\"));\n\n            case 2:\n              value = _context.sent;\n\n              if (value == null) {\n                _this.props.navigation.navigate(\"Login\");\n              }\n\n            case 4:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this.AcceptReq = function _callee2(id) {\n      var value;\n      return _regeneratorRuntime.async(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return _regeneratorRuntime.awrap(AsyncStorage.getItem(\"@session_token\"));\n\n            case 2:\n              value = _context2.sent;\n              return _context2.abrupt(\"return\", fetch(\"http://localhost:3333/api/1.0.0/friendrequests/\" + id, {\n                method: \"POST\",\n                headers: {\n                  \"X-Authorization\": value\n                }\n              }).then(function (response) {\n                if (response.status === 200) {\n                  return response.json();\n                } else if (response.status === 401) {\n                  return response.json();\n                } else {\n                  throw \"Something went wrong\";\n                }\n              }).then(function (responseJson) {\n                _this.getReqList();\n\n                _this.getFriendList();\n              }).catch(function (error) {\n                _this.getReqList();\n\n                _this.getFriendList();\n\n                console.log(error);\n              }));\n\n            case 4:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this.DeclineReq = function _callee3(id) {\n      var value;\n      return _regeneratorRuntime.async(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.next = 2;\n              return _regeneratorRuntime.awrap(AsyncStorage.getItem(\"@session_token\"));\n\n            case 2:\n              value = _context3.sent;\n              return _context3.abrupt(\"return\", fetch(\"http://localhost:3333/api/1.0.0/friendrequests/\" + id, {\n                method: \"DELETE\",\n                headers: {\n                  \"X-Authorization\": value\n                }\n              }).then(function (response) {\n                if (response.status === 200) {\n                  return response.json();\n                } else if (response.status === 401) {\n                  return response.json();\n                } else {\n                  throw \"Something went wrong\";\n                }\n              }).then(function (responseJson) {\n                console.log(responseJson);\n\n                _this.getReqList();\n\n                _this.getFriendList();\n              }).catch(function (error) {\n                _this.getReqList();\n\n                _this.getFriendList();\n\n                console.log(error);\n              }));\n\n            case 4:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this.getFriendList = function _callee4() {\n      var value, id;\n      return _regeneratorRuntime.async(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.next = 2;\n              return _regeneratorRuntime.awrap(AsyncStorage.getItem(\"@session_token\"));\n\n            case 2:\n              value = _context4.sent;\n              _context4.next = 5;\n              return _regeneratorRuntime.awrap(AsyncStorage.getItem(\"@id\"));\n\n            case 5:\n              id = _context4.sent;\n              return _context4.abrupt(\"return\", fetch(\"http://localhost:3333/api/1.0.0/user/\" + id + \"/friends\", {\n                headers: {\n                  \"X-Authorization\": value\n                }\n              }).then(function (response) {\n                if (response.status === 200) {\n                  return response.json();\n                } else if (response.status === 401) {\n                  _this.props.navigation.navigate(\"Login\");\n                } else {\n                  throw \"Something went wrong\";\n                }\n              }).then(function (responseJson) {\n                _this.setState({\n                  FriendList: responseJson,\n                  isLoading: false\n                });\n              }).catch(function (error) {\n                console.log(error);\n              }));\n\n            case 7:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this.getReqList = function _callee5() {\n      var value;\n      return _regeneratorRuntime.async(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              _context5.next = 2;\n              return _regeneratorRuntime.awrap(AsyncStorage.getItem(\"@session_token\"));\n\n            case 2:\n              value = _context5.sent;\n              return _context5.abrupt(\"return\", fetch(\"http://localhost:3333/api/1.0.0/friendrequests\", {\n                headers: {\n                  \"X-Authorization\": value\n                }\n              }).then(function (response) {\n                if (response.status === 200) {\n                  return response.json();\n                } else if (response.status === 401) {\n                  _this.props.navigation.navigate(\"Login\");\n                } else {\n                  throw \"Something went wrong\";\n                }\n              }).then(function (responseJson) {\n                _this.setState({\n                  ReqList: responseJson\n                });\n              }).catch(function (error) {\n                console.log(error);\n              }));\n\n            case 4:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    _this.state = {\n      isLoading: true,\n      ReqList: [],\n      FriendList: [],\n      errorTxt: \"\"\n    };\n    return _this;\n  }\n\n  _createClass(MyFreinds, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      this.unsubscribe = this.props.navigation.addListener(\"focus\", function () {\n        _this2.checkLoggedIn();\n\n        UploadDrafts.dateCheck();\n\n        _this2.getReqList();\n\n        _this2.getFriendList();\n      });\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.unsubscribe();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      if (this.state.isLoading) {\n        return _jsx(View, {\n          style: {\n            flex: 1,\n            flexDirection: \"column\",\n            justifyContent: \"center\",\n            alignItems: \"center\"\n          },\n          children: _jsx(Text, {\n            children: \"Loading..\"\n          })\n        });\n      } else {\n        return _jsxs(View, {\n          children: [_jsx(Text, {\n            style: Style.titleText,\n            children: \"Requests:\"\n          }), _jsx(FlatList, {\n            data: this.state.ReqList,\n            renderItem: function renderItem(_ref) {\n              var item = _ref.item;\n              return _jsxs(ScrollView, {\n                children: [_jsx(TouchableOpacity, {\n                  onPress: function onPress() {\n                    return _this3.props.navigation.navigate(\"Profile\", {\n                      id: String(item.user_id)\n                    });\n                  },\n                  style: Style.buttonStyleDefault,\n                  children: _jsx(Text, {\n                    style: Style.buttonText,\n                    children: item.first_name + \" \" + item.last_name\n                  })\n                }), _jsx(TouchableOpacity, {\n                  onPress: function onPress() {\n                    _this3.AcceptReq(item.user_id);\n                  },\n                  style: Style.AcceptButton,\n                  children: _jsx(Text, {\n                    style: Style.AcceptText,\n                    children: \"Accept\"\n                  })\n                }), _jsx(TouchableOpacity, {\n                  onPress: function onPress() {\n                    _this3.DeclineReq(item.user_id);\n                  },\n                  style: Style.DeclineButton,\n                  children: _jsx(Text, {\n                    style: Style.DeclineText,\n                    children: \"Decline\"\n                  })\n                })]\n              });\n            }\n          }), _jsx(Text, {\n            style: Style.titleText,\n            children: \"Friends List:\"\n          }), _jsx(FlatList, {\n            data: this.state.FriendList,\n            getChildrenName: function getChildrenName(data) {\n              return \"item\";\n            },\n            renderItem: function renderItem(_ref2) {\n              var item = _ref2.item;\n              return _jsxs(ScrollView, {\n                children: [_jsx(Text, {}), _jsx(TouchableOpacity, {\n                  onPress: function onPress() {\n                    return _this3.props.navigation.navigate(\"Profile\", {\n                      id: String(item.user_id)\n                    });\n                  },\n                  style: Style.buttonStyleDefault,\n                  children: _jsx(Text, {\n                    style: Style.buttonText,\n                    children: item.user_givenname + \" \" + item.user_familyname\n                  })\n                })]\n              });\n            },\n            keyExtractor: function keyExtractor(item, index) {\n              return item.user_id.toString();\n            }\n          })]\n        });\n      }\n    }\n  }]);\n\n  return MyFreinds;\n}(Component);\n\nexport default MyFreinds;","map":{"version":3,"sources":["C:/Users/Ruman/Documents/GitHub/spacebook2/components/MyFreinds.js"],"names":["React","Component","AsyncStorage","TouchableOpacity","Style","UploadDrafts","MyFreinds","props","checkLoggedIn","getItem","value","navigation","navigate","AcceptReq","id","fetch","method","headers","then","response","status","json","responseJson","getReqList","getFriendList","catch","error","console","log","DeclineReq","setState","FriendList","isLoading","ReqList","state","errorTxt","unsubscribe","addListener","dateCheck","flex","flexDirection","justifyContent","alignItems","titleText","item","String","user_id","buttonStyleDefault","buttonText","first_name","last_name","AcceptButton","AcceptText","DeclineButton","DeclineText","data","user_givenname","user_familyname","index","toString"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\r\nimport { ScrollView, View, Text, FlatList } from \"react-native\";\r\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\r\nimport { TouchableOpacity } from \"react-native-gesture-handler\";\r\nimport Style from \"./Style\";\r\nimport UploadDrafts from \"./UploadDraft\";\r\n\r\nclass MyFreinds extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      isLoading: true,\r\n      ReqList: [],\r\n      FriendList: [],\r\n      errorTxt: \"\",\r\n    };\r\n  }\r\n  componentDidMount() {\r\n    this.unsubscribe = this.props.navigation.addListener(\"focus\", () => {\r\n      this.checkLoggedIn();\r\n      UploadDrafts.dateCheck(); \r\n      // checks the draft date by the current date\r\n      this.getReqList(); \r\n      //initailises all of the propteries for the page\r\n      this.getFriendList();\r\n    });\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    this.unsubscribe();\r\n  }\r\n\r\n  checkLoggedIn = async () => {\r\n    const value = await AsyncStorage.getItem(\"@session_token\");\r\n\r\n    if (value == null) {\r\n      this.props.navigation.navigate(\"Login\");\r\n    }\r\n  };\r\n  AcceptReq = async (id) => {\r\n    const value = await AsyncStorage.getItem(\"@session_token\");\r\n\r\n    return fetch(\"http://localhost:3333/api/1.0.0/friendrequests/\" + id, {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"X-Authorization\": value,\r\n      },\r\n    })\r\n      .then((response) => {\r\n        if (response.status === 200) {\r\n          return response.json();\r\n        } else if (response.status === 401) {\r\n          return response.json();\r\n        } else {\r\n          throw \"Something went wrong\";\r\n        }\r\n      })\r\n      .then((responseJson) => {\r\n        this.getReqList();\r\n        this.getFriendList();\r\n        //\"reloads\" the page by updating the state of items this way inforamtion is updated without changing pages\r\n      })\r\n      .catch((error) => {\r\n        this.getReqList();\r\n        this.getFriendList();\r\n        console.log(error);\r\n      });\r\n  };\r\n  DeclineReq = async (id) => {\r\n    const value = await AsyncStorage.getItem(\"@session_token\");\r\n\r\n    return fetch(\"http://localhost:3333/api/1.0.0/friendrequests/\" + id, {\r\n      method: \"DELETE\",\r\n      headers: {\r\n        \"X-Authorization\": value,\r\n      },\r\n    })\r\n      .then((response) => {\r\n        if (response.status === 200) {\r\n          return response.json();\r\n        } else if (response.status === 401) {\r\n          return response.json();\r\n        } else {\r\n          throw \"Something went wrong\";\r\n        }\r\n      })\r\n      .then((responseJson) => {\r\n        console.log(responseJson);\r\n        this.getReqList();\r\n        this.getFriendList();\r\n        //state refresh \r\n      })\r\n      .catch((error) => {\r\n        this.getReqList();\r\n        this.getFriendList();\r\n        console.log(error);\r\n      });\r\n  };\r\n  getFriendList = async () => {\r\n    const value = await AsyncStorage.getItem(\"@session_token\");\r\n    const id = await AsyncStorage.getItem(\"@id\");\r\n\r\n    return fetch(\"http://localhost:3333/api/1.0.0/user/\" + id + \"/friends\", {\r\n      headers: {\r\n        \"X-Authorization\": value,\r\n      },\r\n    })\r\n      .then((response) => {\r\n        if (response.status === 200) {\r\n          return response.json();\r\n        } else if (response.status === 401) {\r\n          this.props.navigation.navigate(\"Login\");\r\n        } else {\r\n          throw \"Something went wrong\";\r\n        }\r\n      })\r\n      .then((responseJson) => {\r\n        this.setState({\r\n          FriendList: responseJson,\r\n          isLoading: false,\r\n        });\r\n        // Due to being the last function loaded the \"isLoading\" is set to false (page loads then)\r\n      })\r\n      .catch((error) => {\r\n        console.log(error);\r\n      });\r\n  };\r\n  getReqList = async () => {\r\n    const value = await AsyncStorage.getItem(\"@session_token\");\r\n\r\n    return fetch(\"http://localhost:3333/api/1.0.0/friendrequests\", {\r\n      headers: {\r\n        \"X-Authorization\": value,\r\n      },\r\n    })\r\n      .then((response) => {\r\n        if (response.status === 200) {\r\n          return response.json();\r\n        } else if (response.status === 401) {\r\n          this.props.navigation.navigate(\"Login\");\r\n        } else {\r\n          throw \"Something went wrong\";\r\n        }\r\n      })\r\n      .then((responseJson) => {\r\n        this.setState({\r\n          ReqList: responseJson,\r\n        });\r\n      })\r\n      .catch((error) => {\r\n        console.log(error);\r\n      });\r\n  };\r\n\r\n  render() {\r\n    if (this.state.isLoading) {\r\n      return (\r\n        <View\r\n          style={{\r\n            flex: 1,\r\n            flexDirection: \"column\",\r\n            justifyContent: \"center\",\r\n            alignItems: \"center\",\r\n          }}\r\n        >\r\n          <Text>Loading..</Text>\r\n        </View>\r\n      );\r\n    } else {\r\n      return (\r\n        <View>\r\n          <Text style={Style.titleText}>Requests:</Text>\r\n          <FlatList\r\n            data={this.state.ReqList}\r\n            renderItem={({ item }) => (\r\n              <ScrollView>\r\n                <TouchableOpacity\r\n                  onPress={() =>\r\n                    this.props.navigation.navigate(\"Profile\", {\r\n                      id: String(item.user_id),\r\n                    })\r\n                  }\r\n                  style={Style.buttonStyleDefault}\r\n                >\r\n                  <Text style={Style.buttonText}>\r\n                    {item.first_name + \" \" + item.last_name}\r\n                  </Text>\r\n                </TouchableOpacity>\r\n\r\n                <TouchableOpacity\r\n                  onPress={() => {\r\n                    this.AcceptReq(item.user_id);\r\n                  }}\r\n                  style={Style.AcceptButton}\r\n                >\r\n                  <Text style={Style.AcceptText}>Accept</Text>\r\n                </TouchableOpacity>\r\n\r\n                <TouchableOpacity\r\n                  onPress={() => {\r\n                    this.DeclineReq(item.user_id);\r\n                  }}\r\n                  style={Style.DeclineButton}\r\n                >\r\n                  <Text style={Style.DeclineText}>Decline</Text>\r\n                </TouchableOpacity>\r\n              </ScrollView>\r\n            )}\r\n          />\r\n\r\n          <Text style={Style.titleText}>Friends List:</Text>\r\n\r\n          <FlatList\r\n            data={this.state.FriendList}\r\n            getChildrenName={(data) => \"item\"}\r\n            renderItem={({ item }) => (\r\n              <ScrollView>\r\n                <Text></Text>\r\n\r\n                <TouchableOpacity\r\n                  onPress={() =>\r\n                    this.props.navigation.navigate(\"Profile\", {\r\n                      id: String(item.user_id),\r\n                    })\r\n                  }\r\n                  style={Style.buttonStyleDefault}\r\n                >\r\n                  <Text style={Style.buttonText}>\r\n                    {item.user_givenname + \" \" + item.user_familyname}\r\n                  </Text>\r\n                </TouchableOpacity>\r\n              </ScrollView>\r\n            )}\r\n            keyExtractor={(item, index) => item.user_id.toString()}\r\n          />\r\n        </View>\r\n      );\r\n    }\r\n  }\r\n}\r\n\r\nexport default MyFreinds;\r\n"]},"metadata":{},"sourceType":"module"}